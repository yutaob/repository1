<mxfile host="app.diagrams.net" modified="2021-06-07T03:52:18.321Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36" etag="y8khyqNWGHNrW1ap3bBM" version="14.7.5" type="github">
  <diagram id="AOBUn9HALy5-eKRLtoJs" name="第 1 页">
    <mxGraphModel dx="2036" dy="643" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="oPyZHrdhsSQBrQFMob7v-1" value="DS系统数据" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="310" y="250" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-2" value="工单原表" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="310" y="330" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-3" value="工单表" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="310" y="420" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-4" value="insertTask定时任务" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="480" y="290" width="170" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-5" value="syncWorkorder定时任务" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="480" y="380" width="170" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-6" value="下游（成本）/上游（收入）结算" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="273.5" y="510" width="193" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-9" value="上游应结，上游明细，上游预提" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="266.5" y="1180" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-10" value="结算标识：&lt;br&gt;上游:upShould_is_settle，upShould_settle_count&lt;br&gt;下游:downReal_is_settle，downReal_settle_count" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-420" y="500" width="330" height="50" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-11" value="工单同步，工单上传，甲方应结上传" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-20" y="335" width="290" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-12" value="入口：&lt;br&gt;1，syncWorkorder定时任务执行完成后，调上下游重算&lt;br&gt;&lt;div&gt;&lt;span&gt;2，上游重算按钮，下游重算按钮&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;3，upMoneyCount，downMoneyCount上下游重算定时任务&lt;/span&gt;&lt;/div&gt;&lt;div&gt;结算成功，is_settle = 1,settle_count&amp;nbsp;&lt;span&gt;++&lt;/span&gt;；结算失败，is_settle = 0，settle_count = 1。人工处理异常结费，is_settle=1。结算一次，无论成功失败，count++，当settle=0,count&amp;gt;4时，此工单异常结费。&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-420" y="580" width="350" height="130" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-13" value="1，工单同步：&lt;br&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;同步完成后，上下游结算标识先置为0，然后自动调用上游下游重算，结算成功，is_settle = 1,settle_count &lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;=1；结算失败，is_settle = 0，settle_count = 1。&lt;br&gt;2，工单上传：&lt;br&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;上下游结算标识都置为1。&lt;br&gt;3，甲方应结上传：&lt;br&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;新增工单：结算标识全部置为1，&lt;br&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;更新工单：上游结算标识置为1.&lt;br&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;&lt;br&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-420" y="270" width="410" height="150" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-59" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="120" y="652.75" width="790" height="427.25" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-57" value="" style="group" vertex="1" connectable="0" parent="oPyZHrdhsSQBrQFMob7v-59">
          <mxGeometry width="790" height="427.25" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-45" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry width="479.56639566395665" height="106.26907857546634" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-14" value="同步定时任务，is_settle=0,settle_count=0" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="17.12737127371274" y="35.986574335782926" width="137.01897018970192" height="34.29592990390051" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-15" value="是否成功？" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="196.96476964769647" y="267.84638213680034" width="85.63685636856368" height="43.47371396269078" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="oPyZHrdhsSQBrQFMob7v-57" source="oPyZHrdhsSQBrQFMob7v-14" target="oPyZHrdhsSQBrQFMob7v-15">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="68.50948509485096" y="166.40771622385523" />
              <mxPoint x="239.78319783197833" y="166.40771622385523" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-17" value="settle_count++，&lt;br&gt;is_settle =1" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="188.40108401084012" y="383.77628603730915" width="102.76422764227641" height="43.47371396269078" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="oPyZHrdhsSQBrQFMob7v-57" source="oPyZHrdhsSQBrQFMob7v-15" target="oPyZHrdhsSQBrQFMob7v-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-20" value="是" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;rotation=90;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="231.21951219512198" y="345.1329847371396" width="34.25474254742548" height="19.32165065008479" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-21" value="settle_count++，&lt;br&gt;is_settle =0" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="522.3848238482385" y="271.4691916336913" width="92.05962059620596" height="36.228094968908984" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="oPyZHrdhsSQBrQFMob7v-57" source="oPyZHrdhsSQBrQFMob7v-15" target="oPyZHrdhsSQBrQFMob7v-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-30" value="否" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="316.86" y="257.25" width="34.25" height="31.66" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-37" value="&lt;font style=&quot;font-size: 11px&quot;&gt;(is_settle = 0 &amp;amp;&amp;amp;settle_count&amp;gt;4)?&lt;/font&gt;" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="497.7642276422764" y="132.5948275862069" width="141.30081300813006" height="77.28660260033917" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-46" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="oPyZHrdhsSQBrQFMob7v-57" source="oPyZHrdhsSQBrQFMob7v-21" target="oPyZHrdhsSQBrQFMob7v-37">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.999;entryY=0.43;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="oPyZHrdhsSQBrQFMob7v-57" source="oPyZHrdhsSQBrQFMob7v-38" target="oPyZHrdhsSQBrQFMob7v-45">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="739.9024390243901" y="45.64739966082532" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-38" value="异常结费" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="699.0108401084011" y="156.74689089881286" width="81.35501355013551" height="28.982475975127187" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-48" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="oPyZHrdhsSQBrQFMob7v-57" source="oPyZHrdhsSQBrQFMob7v-37" target="oPyZHrdhsSQBrQFMob7v-38">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="oPyZHrdhsSQBrQFMob7v-57" source="oPyZHrdhsSQBrQFMob7v-39" target="oPyZHrdhsSQBrQFMob7v-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-39" value="手动重算" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="171.27371273712737" y="35.986574335782926" width="137.01897018970192" height="34.29592990390051" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-43" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="oPyZHrdhsSQBrQFMob7v-57" source="oPyZHrdhsSQBrQFMob7v-42" target="oPyZHrdhsSQBrQFMob7v-15">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="391.3604336043361" y="166.40771622385523" />
              <mxPoint x="239.78319783197833" y="166.40771622385523" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-42" value="重算定时任务，只重算is_settle=0的工单" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="322.42276422764223" y="35.986574335782926" width="137.01897018970192" height="34.29592990390051" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-49" value="是" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;dashed=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="655.1219512195122" y="142.25565291124929" width="34.25474254742548" height="19.32165065008479" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-53" value="是" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;dashed=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="569.4850948509486" y="106.26907857546634" width="34.25474254742548" height="19.32165065008479" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-55" value="人工处理异常结费&lt;br&gt;is_settle = 2" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="oPyZHrdhsSQBrQFMob7v-57">
          <mxGeometry x="689.3766937669377" y="388.60669869983036" width="100.62330623306234" height="33.812888637648385" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-56" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="oPyZHrdhsSQBrQFMob7v-57" source="oPyZHrdhsSQBrQFMob7v-38" target="oPyZHrdhsSQBrQFMob7v-55">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="oPyZHrdhsSQBrQFMob7v-58" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="oPyZHrdhsSQBrQFMob7v-59" source="oPyZHrdhsSQBrQFMob7v-37">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="568.4146341463415" y="47.25" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
